<!DOCTYPE html>
<html lang="id">
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Exshoetic Shoes & Care</title> 
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"> 
    <link rel="stylesheet" href="css/kombinasi.css"> 
    <link rel="stylesheet" href="css/cuci.css"> 
    <link rel="icon" href="img/favicon.ico" type="image/x-icon"> <!-- Favicon opsional --> 
</head>
<body>

    <header> 
        <a href="#" class="logo">Exshoetic</a> 
        <nav class="navbar"> 
            <a href="index.html" >Beranda</a> 
            <a href="lokasi.html">Lokasi</a> 
            <a href="layanan.html">Layanan</a> 
            <a href="cuci.html" class="active">Cuci</a> 
            <a href="review.html">Galeri</a> 
        </nav> 
        <div class="icons"> 
            <a href="#" aria-label="Favorit"><i class="fa fa-heart"></i></a> 
            <a href="#" aria-label="Keranjang Belanja"><i class="fa fa-shopping-cart"></i></a> 
            <a href="#" aria-label="Profil Pengguna"><i class="fa fa-user"></i></a> 
        </div> 
    </header>

    <div class="container">
        <div class="form-container">
            <div class="form-header">
                <h1 class="form-title">Form Pemesanan Layanan Cuci Sepatu</h1>
                <div class="service-highlights">
                    <div class="highlight-item"><i class="fas fa-box"></i><span>Packing Aman</span></div>
                    <div class="highlight-item"><i class="fas fa-truck"></i><span>Pickup & Delivery</span></div>
                    <div class="highlight-item"><i class="fas fa-map-marker-alt"></i><span>Tracking Real-time</span></div>
                </div>
            </div>

            <div class="success-message" id="successMessage">Pesanan berhasil dikirim! Kurir kami akan segera menghubungi Anda.</div>

            <form id="shoeServiceForm" action="php/proses_pemesanan.php" method="POST">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="name">Nama Lengkap</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Nomor Telepon</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="address">Alamat Lengkap</label>
                        <input type="text" id="address" name="address" placeholder="Nama Jalan, Nomor Rumah" required>
                    </div>
            
                    <div class="form-group">
                        <label for="service">Jenis Layanan</label>
                        <select id="service" name="treatment_id" onchange="updateHarga()" required>
                            <option value="">Pilih Layanan</option>
                            <option value="1">Deep Clean</option>
                            <option value="2">Fast Clean</option>
                            <option value="3">Unyellowing</option>
                            <option value="4">Repaint</option>
                            <option value="5">Repair Soles</option>
                            <option value="6">Whitening</option>
                            <option value="7">Leather Care</option>
                            <option value="8">Reglue</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="total">Total Tagihan</label>
                        <input type="number" id="total" name="total_bill" required>
                    </div>
            
                    <div class="form-group">
                        <label for="payment_method">Metode Pembayaran</label>
                        <select id="payment_method" name="payment_method" required>
                            <option value="transfer">Transfer Bank</option>
                            <option value="gopay">GoPay</option>
                            <option value="ovo">OVO</option>
                            <option value="dana">Dana</option>
                            <option value="cod">Bayar di Tempat (COD)</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn-submit">Kirim</button>
            </form>
        </div>
    </div>

    <footer> 
        <div class="footer-content"> 
            <div class="footer-section"> 
                <h3>Tentang Kami</h3> 
                <p>Exshoetic adalah mitra terpercaya Anda dalam layanan perawatan sepatu premium. Kami berkomitmen menjaga sepatu Anda agar selalu tampak terbaik.</p> 
            </div> 
            <div class="footer-section"> 
                <h3>Tautan Cepat</h3> 
                <a href="#services">Layanan</a> 
                <a href="#home">Tentang Kami</a> 
                <a href="lokasi.html">Lokasi</a>  
                <a href="#contact">Kontak</a>  
            </div> 
            <div class="footer-section">
                <h3>Info Kontak</h3>
                <p>Email: info@exshoetic.com</p>
                <p>Telepon: (555) 123-4567</p>
                <p>Alamat: Jl. Sepatu No.123, Kawasan Fashion</p>
            </div>
        </div>
        <div>
            <p>Exshoetic Shoes and Care</p>
        </div>
    </footer>

    <script src="js/script.js"></script>
    <script>
        // Javascript untuk mengatur harga layanan
        function updateHarga() {
            const serviceSelect = document.getElementById('service');
            const totalInput = document.getElementById('total');
            const priceMapping = {
                '1': 35000,
                '2': 15000,
                '3': 45000,
                '4': 150000,
                '5': 70000,
                '6': 50000,
                '7': 40000,
                '8': 70000
            };
            totalInput.value = priceMapping[serviceSelect.value] || '';
        }
    </script>
    <script>
        // Mengambil elemen form dan pesan sukses
        const form = document.getElementById("shoeServiceForm");
        const successMessage = document.getElementById("successMessage");
    
        // Fungsi untuk mengirim form menggunakan AJAX
        form.addEventListener("submit", function(event) {
            event.preventDefault(); // Mencegah refresh halaman
    
            const formData = new FormData(form);
    
            // Mengirim data ke PHP menggunakan fetch API
            fetch("php/proses_pemesanan.php", {
                method: "POST",
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === "success") {
                    // Menampilkan pesan sukses
                    successMessage.style.display = "block";
                    successMessage.textContent = data.message;
    
                    // Mengosongkan form
                    form.reset();
    
                    // Sembunyikan pesan sukses setelah beberapa detik
                    setTimeout(() => {
                        successMessage.style.display = "none";
                    }, 5000);
                } else {
                    alert(data.message); // Tampilkan pesan error jika ada
                }
            })
            .catch(error => {
                alert("Terjadi kesalahan saat mengirim pesanan. Silakan coba lagi.");
                console.error("Error:", error);
            });
        });
    </script> 
    <script> 
        // Fungsi untuk mendapatkan parameter dari URL
function getUrlParameter(name) {
    name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
    const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
    const results = regex.exec(location.search);
    return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
}

// Fungsi untuk mengatur layanan berdasarkan parameter URL
function setServiceFromUrl() {
    const serviceParam = getUrlParameter('service');
    if (!serviceParam) return;

    const serviceSelect = document.getElementById('service');
    if (!serviceSelect) return;

    // Mapping URL parameter ke value pada select option
    const serviceMapping = {
        'fast-clean': '2',
        'deep-clean': '1',
        'unyellowing': '3',
        'repaint': '4',
        'repair-sol': '5',
        'whitening': '6',
        'leather-care': '7',
        'reglue': '8'
    };

    const serviceValue = serviceMapping[serviceParam];
    if (serviceValue) {
        serviceSelect.value = serviceValue;
        // Trigger event change untuk mengupdate harga
        updateHarga();
    }
}

// Jalankan fungsi saat halaman dimuat
document.addEventListener('DOMContentLoaded', function() {
    setServiceFromUrl();
});
    </script> 
</body>
</html>
